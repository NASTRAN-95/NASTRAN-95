!*==sihex2.f90  processed by SPAG 7.61RG at 01:00 on 21 Mar 2022
 
SUBROUTINE sihex2(Type,Gpt,Nip,Strspt,Istore)
   IMPLICIT NONE
   USE c_sdr2x2
   USE c_sdr2x4
   USE c_sdr2x7
   USE c_sdr2x8
   USE c_sdr2x9
   USE c_system
   USE c_zzzzzz
!
! Dummy argument declarations rewritten by SPAG
!
   INTEGER :: Type
   REAL , DIMENSION(1) :: Gpt
   INTEGER :: Nip
   INTEGER :: Strspt
   INTEGER :: Istore
!
! Local variable declarations rewritten by SPAG
!
   REAL :: ax , sx , sxy , sy , syz , sz , szx , thresh
   REAL , DIMENSION(6) :: csig
   REAL , DIMENSION(126) :: csigs , sigs
   REAL , SAVE :: dtor
   REAL , DIMENSION(152) , SAVE :: ex2021 , ex2041 , ex2042 , ex2043 , ex2044 , ex2045 , ex2046 , ex2047 , ex2048 , ex8g41 ,        &
                                 & ex8g42 , ex8g43
   REAL , DIMENSION(16) , SAVE :: ex2022
   REAL , DIMENSION(132) , SAVE :: ex2031 , ex8g31
   REAL , DIMENSION(127) , SAVE :: ex2032 , ex2033 , ex2034
   REAL , DIMENSION(54) , SAVE :: ex2035
   REAL , DIMENSION(128) , SAVE :: ex2049
   REAL , DIMENSION(168) :: ex20g2
   REAL , DIMENSION(567) :: ex20g3
   REAL , DIMENSION(1344) :: ex20g4
   REAL , DIMENSION(72) , SAVE :: ex8g2
   REAL , DIMENSION(243) :: ex8g3
   REAL , DIMENSION(111) , SAVE :: ex8g32
   REAL , DIMENSION(576) :: ex8g4
   REAL , DIMENSION(120) , SAVE :: ex8g44
   INTEGER , DIMENSION(32) :: extrnl
   REAL , DIMENSION(2) , SAVE :: frlast
   INTEGER , DIMENSION(1) :: iesta
   INTEGER , DIMENSION(11) :: ifrvec , istrs
   INTEGER :: ipoint , isave , jj , kk , ngp1 , nip3
   INTEGER , DIMENSION(7) :: ishd
   INTEGER , SAVE :: lld , lsub , nequ , oldeid
   REAL , DIMENSION(3) :: sigp
   REAL , DIMENSION(3,3) :: smat
   REAL , DIMENSION(384) :: store
   REAL , DIMENSION(10) :: stress
   INTEGER , DIMENSION(4) , SAVE :: typ
!
! End of declarations rewritten by SPAG
!
!
! Dummy argument declarations rewritten by SPAG
!
!
! Local variable declarations rewritten by SPAG
!
!
! End of declarations rewritten by SPAG
!
!
!     PHASE 2 STRESS DATA RECOVERY FOR IHEX1, IHEX2, AND IHEX3 ELEMENTS
!
!           TYPE = 1    IHEX1
!           TYPE = 2    IHEX2
!           TYPE = 3    IHEX3
!
!***********************************************************************
!
!     ARRAY ESTA CONTAINS THE FOLLOWING WHERE NGP IS THE NUMBER OF
!     GRID POINTS
!
!           ELEMENT ID
!           NGP SIL NUMBERS
!           NGP VALUES OF THE SHAPE FUNCTIONS AT THIS STRESS POINT
!           REFERENCE TEMPERATURE
!           6 THERMAL STRESS COEFFICIENTS
!           NGP 6 BY 3 MATRICES RELATING STRESS TO DISPLACEMENTS
!                 AT THIS STRESS POINT (STORED ROW-WISE)
!
!     PHIOUT STARTS AT ESTA(101)
!
!***********************************************************************
!
!
!
!
!
!
!
!
!
!     COMMON /SDRETT/ DUM(9) ,OLDEID
!
!
   !>>>>EQUIVALENCE (Iesta(1),Esta(1)) , (Stress(1),Istrs(1),Esta(101))
!
   !>>>>EQUIVALENCE (Sigp(1),Sa) , (Sig(1),Sx) , (Sig(2),Sy) , (Sig(3),Sz) , (Sig(4),Sxy) , (Sig(5),Syz) , (Sig(6),Szx) ,                &
!>>>>    & (csig(1),ifrvec(6))
!
   !>>>>EQUIVALENCE (lsub,ishd(1)) , (lld,ishd(2)) , (frlast(1),ishd(6))
   !>>>>EQUIVALENCE (ex20g3(1),ex2031(1)) , (ex20g3(133),ex2032(1)) , (ex20g3(260),ex2033(1)) , (ex20g3(387),ex2034(1)) ,                &
!>>>>    & (ex20g3(514),ex2035(1))
   !>>>>EQUIVALENCE (ex8g3(1),ex8g31(1)) , (ex8g3(133),ex8g32(1))
   !>>>>EQUIVALENCE (ex20g2(1),ex2021(1)) , (ex20g2(153),ex2022(1))
   !>>>>EQUIVALENCE (ex8g4(1),ex8g41(1)) , (ex8g4(153),ex8g42(1)) , (ex8g4(305),ex8g43(1)) , (ex8g4(457),ex8g44(1))
   !>>>>EQUIVALENCE (ex20g4(1),ex2041(1)) , (ex20g4(153),ex2042(1)) , (ex20g4(305),ex2043(1)) , (ex20g4(457),ex2044(1)) ,                &
!>>>>    & (ex20g4(609),ex2045(1)) , (ex20g4(761),ex2046(1)) , (ex20g4(913),ex2047(1)) , (ex20g4(1065),ex2048(1)) ,                      &
!>>>>    & (ex20g4(1217),ex2049(1))
   DATA ex8g2/ - .0490 , .1830 , .1830 , -.6830 , .1830 , -.6830 , -.6830 , 2.5490 , .1830 , -.6830 , -.6830 , 2.5490 , -.0490 ,    &
      & .1830 , .1830 , -.6830 , -.6830 , 2.5490 , .1830 , -.6830 , .1830 , -.6830 , -.0490 , .1830 , .1830 , -.6830 , -.0490 ,     &
      & .1830 , -.6830 , 2.5490 , .1830 , -.6830 , .1830 , -.0490 , -.6830 , .1830 , -.6830 , .1830 , 2.5490 , -.6830 , -.6830 ,    &
      & .1830 , 2.5490 , -.6830 , .1830 , -.0490 , -.6830 , .1830 , 2.5490 , -.6830 , -.6830 , .1830 , -.6830 , .1830 , .1830 ,     &
      & -.0490 , -.6830 , .1830 , .1830 , -.0490 , 2.5490 , -.6830 , -.6830 , .1830 , .1250 , .1250 , .1250 , .1250 , .1250 ,       &
      & .1250 , .1250 , .1250/
   DATA ex8g31/.0066 , -.0235 , .0522 , -.0235 , .0835 , -.1852 , .0522 , -.1852 , .4108 , -.0235 , .0835 , -.1852 , .0835 ,        &
      & -.2963 , .6573 , -.1852 , .6573 , -1.4580 , .0522 , -.1852 , .4108 , -.1852 , .6573 , -1.4580 , .4108 , -1.4580 , 3.2341 ,  &
      & .0522 , -.1852 , .4108 , -.1852 , .6573 , -1.4580 , .4108 , -1.4580 , 3.2341 , -.0235 , .0835 , -.1852 , .0835 , -.2963 ,   &
      & .6573 , -.1852 , .6573 , -1.4580 , .0066 , -.0235 , .0522 , -.0235 , .0835 , -.1852 , .0522 , -.1852 , .4108 , .4108 ,      &
      & -1.4580 , 3.2341 , -.1852 , .6573 , -1.4580 , .0522 , -.1852 , .4108 , -.1852 , .6573 , -1.4580 , .0835 , -.2963 , .6573 ,  &
      & -.0235 , .0835 , -.1852 , .0522 , -.1852 , .4108 , -.0235 , .0835 , -.1852 , .0066 , -.0235 , .0522 , .0522 , -.1852 ,      &
      & .4108 , -.0235 , .0835 , -.1852 , .0066 , -.0235 , .0522 , -.1852 , .6573 , -1.4580 , .0835 , -.2963 , .6573 , -.0235 ,     &
      & .0835 , -.1852 , .4108 , -1.4580 , 3.2341 , -.1852 , .6573 , -1.4580 , .0522 , -.1852 , .4108 , .0522 , -.0235 , .0066 ,    &
      & -.1852 , .0835 , -.0235 , .4108 , -.1852 , .0522 , -.1852 , .0835 , -.0235 , .6573 , -.2963 , .0835 , -1.4580 , .6573 ,     &
      & -.1852 , .4108 , -.1852 , .0522 , -1.4580 , .6573 , -.1852/
   DATA ex8g32/3.2341 , -1.4580 , .4108 , .4108 , -.1852 , .0522 , -1.4580 , .6573 , -.1852 , 3.2341 , -1.4580 , .4108 , -.1852 ,   &
      & .0835 , -.0235 , .6573 , -.2963 , .0835 , -1.4580 , .6573 , -.1852 , .0522 , -.0235 , .0066 , -.1852 , .0835 , -.0235 ,     &
      & .4108 , -.1852 , .0522 , 3.2341 , -1.4580 , .4108 , -1.4580 , .6573 , -.1852 , .4108 , -.1852 , .0522 , -1.4580 , .6573 ,   &
      & -.1852 , .6573 , -.2963 , .0835 , -.1852 , .0835 , -.0235 , .4108 , -.1852 , .0522 , -.1852 , .0835 , -.0235 , .0522 ,      &
      & -.0235 , .0066 , .4108 , -.1852 , .0522 , -.1852 , .0835 , -.0235 , .0522 , -.0235 , .0066 , -1.4580 , .6573 , -.1852 ,     &
      & .6573 , -.2963 , .0835 , -.1852 , .0835 , -.0235 , 3.2341 , -1.4580 , .4108 , -1.4580 , .6573 , -.1852 , .4108 , -.1852 ,   &
      & .0522 , -.0000 , .0000 , .0000 , .0000 , .0000 , .0000 , .0000 , -.0000 , -.0000 , 0.0000 , .0000 , .0000 , .0000 , 1.0000 ,&
      & .0000 , -.0000 , -.0000 , -.0000 , .0000 , .0000 , -.0000 , -.0000 , .0000 , .0000 , -.0000 , .0000 , .0000/
   DATA ex8g41/ - .0015 , .0052 , -.0106 , .0198 , .0052 , -.0183 , .0371 , -.0697 , -.0106 , .0371 , -.0754 , .1415 , .0198 ,      &
      & -.0697 , .1415 , -.2656 , .0052 , -.0183 , .0371 , -.0697 , -.0183 , .0644 , -.1307 , .2452 , .0371 , -.1307 , .2653 ,      &
      & -.4978 , -.0697 , .2452 , -.4978 , .9342 , -.0106 , .0371 , -.0754 , .1415 , .0371 , -.1307 , .2653 , -.4978 , -.0754 ,     &
      & .2653 , -.5386 , 1.0107 , .1415 , -.4978 , 1.0107 , -1.8966 , .0198 , -.0697 , .1415 , -.2656 , -.0697 , .2452 , -.4978 ,   &
      & .9342 , .1415 , -.4978 , 1.0107 , -1.8966 , -.2656 , .9342 , -1.8966 , 3.5591 , .0198 , -.0697 , .1415 , -.2656 , -.0697 ,  &
      & .2452 , -.4978 , .9342 , .1415 , -.4978 , 1.0107 , -1.8966 , -.2656 , .9342 , -1.8966 , 3.5591 , -.0106 , .0371 , -.0754 ,  &
      & .1415 , .0371 , -.1307 , .2653 , -.4978 , -.0754 , .2653 , -.5386 , 1.0107 , .1415 , -.4978 , 1.0107 , -1.8966 , .0052 ,    &
      & -.0183 , .0371 , -.0697 , -.0183 , .0644 , -.1307 , .2452 , .0371 , -.1307 , .2653 , -.4978 , -.0697 , .2452 , -.4978 ,     &
      & .9342 , -.0015 , .0052 , -.0106 , .0198 , .0052 , -.0183 , .0371 , -.0697 , -.0106 , .0371 , -.0754 , .1415 , .0198 ,       &
      & -.0697 , .1415 , -.2656 , -.2656 , .9342 , -1.8966 , 3.5591 , .1415 , -.4978 , 1.0107 , -1.8966 , -.0697 , .2452 , -.4978 , &
      & .9342 , .0198 , -.0697 , .1415 , -.2656 , .1415 , -.4978 , 1.0107 , -1.8966 , -.0754 , .2653 , -.5386 , 1.0107/
   DATA ex8g42/.0371 , -.1307 , .2653 , -.4978 , -.0106 , .0371 , -.0754 , .1415 , -.0697 , .2452 , -.4978 , .9342 , .0371 ,        &
      & -.1307 , .2653 , -.4978 , -.0183 , .0644 , -.1307 , .2452 , .0052 , -.0183 , .0371 , -.0697 , .0198 , -.0697 , .1415 ,      &
      & -.2656 , -.0106 , .0371 , -.0754 , .1415 , .0052 , -.0183 , .0371 , -.0697 , -.0015 , .0052 , -.0106 , .0198 , .0198 ,      &
      & -.0697 , .1415 , -.2656 , -.0106 , .0371 , -.0754 , .1415 , .0052 , -.0183 , .0371 , -.0697 , -.0015 , .0052 , -.0106 ,     &
      & .0198 , -.0697 , .2452 , -.4978 , .9342 , .0371 , -.1307 , .2653 , -.4978 , -.0183 , .0644 , -.1307 , .2452 , .0052 ,       &
      & -.0183 , .0371 , -.0697 , .1415 , -.4978 , 1.0107 , -1.8966 , -.0754 , .2653 , -.5386 , 1.0107 , .0371 , -.1307 , .2653 ,   &
      & -.4978 , -.0106 , .0371 , -.0754 , .1415 , -.2656 , .9342 , -1.8966 , 3.5591 , .1415 , -.4978 , 1.0107 , -1.8966 , -.0697 , &
      & .2452 , -.4978 , .9342 , .0198 , -.0697 , .1415 , -.2656 , .0198 , -.0106 , .0052 , -.0015 , -.0697 , .0371 , -.0183 ,      &
      & .0052 , .1415 , -.0754 , .0371 , -.0106 , -.2656 , .1415 , -.0697 , .0198 , -.0697 , .0371 , -.0183 , .0052 , .2452 ,       &
      & -.1307 , .0644 , -.0183 , -.4978 , .2653 , -.1307 , .0371 , .9342 , -.4978 , .2452 , -.0697 , .1415 , -.0754 , .0371 ,      &
      & -.0106 , -.4978 , .2653 , -.1307 , .0371 , 1.0107 , -.5386 , .2653 , -.0754 , -1.8966 , 1.0107 , -.4978 , .1415/
   DATA ex8g43/ - .2656 , .1415 , -.0697 , .0198 , .9342 , -.4978 , .2452 , -.0697 , -1.8966 , 1.0107 , -.4978 , .1415 , 3.5591 ,   &
      & -1.8966 , .9342 , -.2656 , -.2656 , .1415 , -.0697 , .0198 , .9342 , -.4978 , .2452 , -.0697 , -1.8966 , 1.0107 , -.4978 ,  &
      & .1415 , 3.5591 , -1.8966 , .9342 , -.2656 , .1415 , -.0754 , .0371 , -.0106 , -.4978 , .2653 , -.1307 , .0371 , 1.0107 ,    &
      & -.5386 , .2653 , -.0754 , -1.8966 , 1.0107 , -.4978 , .1415 , -.0697 , .0371 , -.0183 , .0052 , .2452 , -.1307 , .0644 ,    &
      & -.0183 , -.4978 , .2653 , -.1307 , .0371 , .9342 , -.4978 , .2452 , -.0697 , .0198 , -.0106 , .0052 , -.0015 , -.0697 ,     &
      & .0371 , -.0183 , .0052 , .1415 , -.0754 , .0371 , -.0106 , -.2656 , .1415 , -.0697 , .0198 , 3.5591 , -1.8966 , .9342 ,     &
      & -.2656 , -1.8966 , 1.0107 , -.4978 , .1415 , .9342 , -.4978 , .2452 , -.0697 , -.2656 , .1415 , -.0697 , .0198 , -1.8966 ,  &
      & 1.0107 , -.4978 , .1415 , 1.0107 , -.5386 , .2653 , -.0754 , -.4978 , .2653 , -.1307 , .0371 , .1415 , -.0754 , .0371 ,     &
      & -.0106 , .9342 , -.4978 , .2452 , -.0697 , -.4978 , .2653 , -.1307 , .0371 , .2452 , -.1307 , .0644 , -.0183 , -.0697 ,     &
      & .0371 , -.0183 , .0052 , -.2656 , .1415 , -.0697 , .0198 , .1415 , -.0754 , .0371 , -.0106 , -.0697 , .0371 , -.0183 ,      &
      & .0052 , .0198 , -.0106 , .0052 , -.0015 , -.2656 , .1415 , -.0697 , .0198 , .1415 , -.0754 , .0371 , -.0106/
   DATA ex8g44/ - .0697 , .0371 , -.0183 , .0052 , .0198 , -.0106 , .0052 , -.0015 , .9342 , -.4978 , .2452 , -.0697 , -.4978 ,     &
      & .2653 , -.1307 , .0371 , .2452 , -.1307 , .0644 , -.0183 , -.0697 , .0371 , -.0183 , .0052 , -1.8966 , 1.0107 , -.4978 ,    &
      & .1415 , 1.0107 , -.5386 , .2653 , -.0754 , -.4978 , .2653 , -.1307 , .0371 , .1415 , -.0754 , .0371 , -.0106 , 3.5591 ,     &
      & -1.8966 , .9342 , -.2656 , -1.8966 , 1.0107 , -.4978 , .1415 , .9342 , -.4978 , .2452 , -.0697 , -.2656 , .1415 , -.0697 ,  &
      & .0198 , -.0008 , .0050 , .0050 , -.0008 , .0050 , -.0324 , -.0324 , .0050 , .0050 , -.0324 , -.0324 , .0050 , -.0008 ,      &
      & .0050 , .0050 , -.0008 , .0050 , -.0324 , -.0324 , .0050 , -.0324 , .2078 , .2078 , -.0324 , -.0324 , .2078 , .2078 ,       &
      & -.0324 , .0050 , -.0324 , -.0324 , .0050 , .0050 , -.0324 , -.0324 , .0050 , -.0324 , .2078 , .2078 , -.0324 , -.0324 ,     &
      & .2078 , .2078 , -.0324 , .0050 , -.0324 , -.0324 , .0050 , -.0008 , .0050 , .0050 , -.0008 , .0050 , -.0324 , -.0324 ,      &
      & .0050 , .0050 , -.0324 , -.0324 , .0050 , -.0008 , .0050 , .0050 , -.0008/
   DATA ex2021/ - .0490 , .1830 , .1830 , -.6830 , .1830 , -.6830 , -.6830 , 2.5490 , .0670 , -.2500 , -.2500 , .9330 , .0670 ,     &
      & -.2500 , -.2500 , .9330 , .1830 , -.6830 , -.6830 , 2.5490 , -.0490 , .1830 , .1830 , -.6830 , -.2500 , .9330 , -.2500 ,    &
      & .9330 , .0670 , -.2500 , .0670 , -.2500 , -.6830 , 2.5490 , .1830 , -.6830 , .1830 , -.6830 , -.0490 , .1830 , -.2500 ,     &
      & .9330 , .0670 , -.2500 , -.2500 , .9330 , .0670 , -.2500 , .1830 , -.6830 , -.0490 , .1830 , -.6830 , 2.5490 , .1830 ,      &
      & -.6830 , .0670 , -.2500 , .0670 , -.2500 , -.2500 , .9330 , -.2500 , .9330 , .0670 , .0670 , -.2500 , -.2500 , -.2500 ,     &
      & -.2500 , .9330 , .9330 , -.2500 , -.2500 , .9330 , .9330 , .0670 , .0670 , -.2500 , -.2500 , .9330 , .9330 , -.2500 ,       &
      & -.2500 , -.2500 , -.2500 , .0670 , .0670 , -.2500 , -.2500 , .0670 , .0670 , .9330 , .9330 , -.2500 , -.2500 , .1830 ,      &
      & -.0490 , -.6830 , .1830 , -.6830 , .1830 , 2.5490 , -.6830 , -.2500 , .0670 , .9330 , -.2500 , -.2500 , .0670 , .9330 ,     &
      & -.2500 , -.6830 , .1830 , 2.5490 , -.6830 , .1830 , -.0490 , -.6830 , .1830 , .9330 , -.2500 , .9330 , -.2500 , -.2500 ,    &
      & .0670 , -.2500 , .0670 , 2.5490 , -.6830 , -.6830 , .1830 , -.6830 , .1830 , .1830 , -.0490 , .9330 , -.2500 , -.2500 ,     &
      & .0670 , .9330 , -.2500 , -.2500 , .0670 , -.6830 , .1830 , .1830 , -.0490 , 2.5490 , -.6830 , -.6830 , .1830/
   DATA ex2022/ - .2500 , .0670 , -.2500 , .0670 , .9330 , -.2500 , .9330 , -.2500 , .1250 , .1250 , .1250 , .1250 , .1250 , .1250 ,&
      & .1250 , .1250/
   DATA ex2031/.0066 , -.0235 , .0522 , -.0235 , .0835 , -.1852 , .0522 , -.1852 , .4108 , -.0235 , .0835 , -.1852 , .0835 ,        &
      & -.2963 , .6573 , -.1852 , .6573 , -1.4580 , .0522 , -.1852 , .4108 , -.1852 , .6573 , -1.4580 , .4108 , -1.4580 , 3.2341 ,  &
      & -.0000 , .0000 , -.0000 , .0000 , -.0000 , .0000 , -.0000 , .0000 , -.0000 , .0353 , -.1252 , .2778 , -.1252 , .4444 ,      &
      & -.9859 , .2778 , -.9859 , 2.1869 , .0000 , .0000 , -.0000 , -.0000 , .0000 , .0000 , -.0000 , .0000 , .0000 , .0522 ,       &
      & -.1852 , .4108 , -.1852 , .6573 , -1.4580 , .4108 , -1.4580 , 3.2341 , -.0235 , .0835 , -.1852 , .0835 , -.2963 , .6573 ,   &
      & -.1852 , .6573 , -1.4580 , .0066 , -.0235 , .0522 , -.0235 , .0835 , -.1852 , .0522 , -.1852 , .4108 , -.0000 , .0000 ,     &
      & .0000 , .2778 , -.9859 , 2.1869 , .0000 , .0000 , -.0000 , .0000 , .0000 , .0000 , -.1252 , .4444 , -.9859 , -.0000 ,       &
      & .0000 , -.0000 , -.0000 , -.0000 , .0000 , .0353 , -.1252 , .2778 , -.0000 , .0000 , -.0000 , .4108 , -1.4580 , 3.2341 ,    &
      & -.1852 , .6573 , -1.4580 , .0522 , -.1852 , .4108 , -.1852 , .6573 , -1.4580 , .0835 , -.2963 , .6573 , -.0235 , .0835 ,    &
      & -.1852 , .0522 , -.1852 , .4108 , -.0235 , .0835 , -.1852/
   DATA ex2032/.0066 , -.0235 , .0522 , -.0000 , .0000 , -.0000 , .0000 , -.0000 , .0000 , .0000 , .0000 , -.0000 , .2778 , -.9859 ,&
      & 2.1869 , -.1252 , .4444 , -.9859 , .0353 , -.1252 , .2778 , .0000 , .0000 , .0000 , -.0000 , .0000 , .0000 , -.0000 ,       &
      & .0000 , -.0000 , .0522 , -.1852 , .4108 , -.0235 , .0835 , -.1852 , .0066 , -.0235 , .0522 , -.1852 , .6573 , -1.4580 ,     &
      & .0835 , -.2963 , .6573 , -.0235 , .0835 , -.1852 , .4108 , -1.4580 , 3.2341 , -.1852 , .6573 , -1.4580 , .0522 , -.1852 ,   &
      & .4108 , -.0000 , .0000 , -.0000 , .0353 , -.1252 , .2778 , .0000 , .0000 , -.0000 , .0000 , .0000 , .0000 , -.1252 , .4444 ,&
      & -.9859 , -.0000 , .0000 , -.0000 , -.0000 , .0000 , .0000 , .2778 , -.9859 , 2.1869 , -.0000 , -.0000 , -.0000 , -.0000 ,   &
      & .0353 , .0000 , .0000 , -.1252 , .0000 , -.0000 , .2778 , -.0000 , .0000 , -.1252 , .0000 , .0000 , .4444 , .0000 , .0000 , &
      & -.9859 , -.0000 , .0000 , .2778 , -.0000 , -.0000 , -.9859 , -.0000 , .0000 , 2.1869 , .0000 , -.0000 , .2778 , -.0000 ,    &
      & .0000 , -.9859 , .0000 , -.0000 , 2.1869 , .0000 , .0000 , -.1252 , .0000 , .0000 , .4444 , .0000 , .0000/
   DATA ex2033/ - .9859 , -.0000 , -.0000 , .0353 , .0000 , -.0000 , -.1252 , -.0000 , -.0000 , .2778 , -.0000 , -.0000 , 2.1869 ,  &
      & -.0000 , .0000 , -.9859 , .0000 , -.0000 , .2778 , -.0000 , .0000 , -.9859 , .0000 , .0000 , .4444 , .0000 , -.0000 ,       &
      & -.1252 , -.0000 , -.0000 , .2778 , .0000 , -.0000 , -.1252 , -.0000 , -.0000 , .0353 , .0000 , -.0000 , .2778 , -.0000 ,    &
      & .0000 , -.1252 , .0000 , -.0000 , .0353 , .0000 , .0000 , -.9859 , .0000 , .0000 , .4444 , .0000 , -.0000 , -.1252 ,        &
      & -.0000 , .0000 , 2.1869 , .0000 , -.0000 , -.9859 , -.0000 , -.0000 , .2778 , .0000 , .0522 , -.0235 , .0066 , -.1852 ,     &
      & .0835 , -.0235 , .4108 , -.1852 , .0522 , -.1852 , .0835 , -.0235 , .6573 , -.2963 , .0835 , -1.4580 , .6573 , -.1852 ,     &
      & .4108 , -.1852 , .0522 , -1.4580 , .6573 , -.1852 , 3.2341 , -1.4580 , .4108 , -.0000 , .0000 , -.0000 , .0000 , -.0000 ,   &
      & .0000 , -.0000 , .0000 , -.0000 , .2778 , -.1252 , .0353 , -.9859 , .4444 , -.1252 , 2.1869 , -.9859 , .2778 , .0000 ,      &
      & .0000 , .0000 , -.0000 , .0000 , .0000 , -.0000 , .0000 , .0000 , .4108 , -.1852 , .0522 , -1.4580 , .6573 , -.1852 ,       &
      & 3.2341 , -1.4580/
   DATA ex2034/.4108 , -.1852 , .0835 , -.0235 , .6573 , -.2963 , .0835 , -1.4580 , .6573 , -.1852 , .0522 , -.0235 , .0066 ,       &
      & -.1852 , .0835 , -.0235 , .4108 , -.1852 , .0522 , -.0000 , .0000 , -.0000 , 2.1869 , -.9859 , .2778 , -.0000 , .0000 ,     &
      & -.0000 , .0000 , .0000 , .0000 , -.9859 , .4444 , -.1252 , -.0000 , .0000 , -.0000 , -.0000 , -.0000 , -.0000 , .2778 ,     &
      & -.1252 , .0353 , -.0000 , .0000 , -.0000 , 3.2341 , -1.4580 , .4108 , -1.4580 , .6573 , -.1852 , .4108 , -.1852 , .0522 ,   &
      & -1.4580 , .6573 , -.1852 , .6573 , -.2963 , .0835 , -.1852 , .0835 , -.0235 , .4108 , -.1852 , .0522 , -.1852 , .0835 ,     &
      & -.0235 , .0522 , -.0235 , .0066 , -.0000 , .0000 , -.0000 , .0000 , -.0000 , .0000 , -.0000 , .0000 , -.0000 , 2.1869 ,     &
      & -.9859 , .2778 , -.9859 , .4444 , -.1252 , .2778 , -.1252 , .0353 , .0000 , .0000 , .0000 , -.0000 , .0000 , .0000 ,        &
      & -.0000 , .0000 , -.0000 , .4108 , -.1852 , .0522 , -.1852 , .0835 , -.0235 , .0522 , -.0235 , .0066 , -1.4580 , .6573 ,     &
      & -.1852 , .6573 , -.2963 , .0835 , -.1852 , .0835 , -.0235 , 3.2341 , -1.4580 , .4108 , -1.4580 , .6573 , -.1852 , .4108 ,   &
      & -.1852 , .0522/
   DATA ex2035/ - .0000 , .0000 , -.0000 , .2778 , -.1252 , .0353 , -.0000 , .0000 , .0000 , .0000 , .0000 , .0000 , -.9859 ,       &
      & .4444 , -.1252 , -.0000 , .0000 , -.0000 , .0000 , .0000 , .0000 , 2.1869 , -.9859 , .2778 , -.0000 , -.0000 , -.0000 ,     &
      & -.0000 , .0000 , .0000 , .0000 , .0000 , .0000 , .0000 , -.0000 , -.0000 , 0.0000 , .0000 , .0000 , .0000 , 1.0000 , .0000 ,&
      & -.0000 , -.0000 , -.0000 , .0000 , .0000 , -.0000 , -.0000 , .0000 , .0000 , -.0000 , .0000 , .0000/
   DATA ex2041/ - .0015 , .0052 , -.0106 , .0198 , .0052 , -.0183 , .0371 , -.0697 , -.0106 , .0371 , -.0754 , .1415 , .0198 ,      &
      & -.0697 , .1415 , -.2656 , .0052 , -.0183 , .0371 , -.0697 , -.0183 , .0644 , -.1307 , .2452 , .0371 , -.1307 , .2653 ,      &
      & -.4978 , -.0697 , .2452 , -.4978 , .9342 , -.0106 , .0371 , -.0754 , .1415 , .0371 , -.1307 , .2653 , -.4978 , -.0754 ,     &
      & .2653 , -.5386 , 1.0107 , .1415 , -.4978 , 1.0107 , -1.8966 , .0198 , -.0697 , .1415 , -.2656 , -.0697 , .2452 , -.4978 ,   &
      & .9342 , .1415 , -.4978 , 1.0107 , -1.8966 , -.2656 , .9342 , -1.8966 , 3.5591 , -.0012 , .0042 , -.0086 , .0161 , .0042 ,   &
      & -.0148 , .0301 , -.0565 , -.0086 , .0301 , -.0611 , .1147 , .0161 , -.0565 , .1147 , -.2152 , .0077 , -.0270 , .0549 ,      &
      & -.1030 , -.0270 , .0951 , -.1931 , .3624 , .0549 , -.1931 , .3921 , -.7358 , -.1030 , .3624 , -.7358 , 1.3808 , .0077 ,     &
      & -.0270 , .0549 , -.1030 , -.0270 , .0951 , -.1931 , .3624 , .0549 , -.1931 , .3921 , -.7358 , -.1030 , .3624 , -.7358 ,     &
      & 1.3808 , -.0012 , .0042 , -.0086 , .0161 , .0042 , -.0148 , .0301 , -.0565 , -.0086 , .0301 , -.0611 , .1147 , .0161 ,      &
      & -.0565 , .1147 , -.2152 , .0198 , -.0697 , .1415 , -.2656 , -.0697 , .2452 , -.4978 , .9342 , .1415 , -.4978 , 1.0107 ,     &
      & -1.8966 , -.2656 , .9342 , -1.8966 , 3.5591 , -.0106 , .0371 , -.0754 , .1415 , .0371 , -.1307 , .2653 , -.4978/
   DATA ex2042/ - .0754 , .2653 , -.5386 , 1.0107 , .1415 , -.4978 , 1.0107 , -1.8966 , .0052 , -.0183 , .0371 , -.0697 , -.0183 ,  &
      & .0644 , -.1307 , .2452 , .0371 , -.1307 , .2653 , -.4978 , -.0697 , .2452 , -.4978 , .9342 , -.0015 , .0052 , -.0106 ,      &
      & .0198 , .0052 , -.0183 , .0371 , -.0697 , -.0106 , .0371 , -.0754 , .1415 , .0198 , -.0697 , .1415 , -.2656 , .0161 ,       &
      & -.0565 , .1147 , -.2152 , -.1030 , .3624 , -.7358 , 1.3808 , -.1030 , .3624 , -.7358 , 1.3808 , .0161 , -.0565 , .1147 ,    &
      & -.2152 , -.0086 , .0301 , -.0611 , .1147 , .0549 , -.1931 , .3921 , -.7358 , .0549 , -.1931 , .3921 , -.7358 , -.0086 ,     &
      & .0301 , -.0611 , .1147 , .0042 , -.0148 , .0301 , -.0565 , -.0270 , .0951 , -.1931 , .3624 , -.0270 , .0951 , -.1931 ,      &
      & .3624 , .0042 , -.0148 , .0301 , -.0565 , -.0012 , .0042 , -.0086 , .0161 , .0077 , -.0270 , .0549 , -.1030 , .0077 ,       &
      & -.0270 , .0549 , -.1030 , -.0012 , .0042 , -.0086 , .0161 , -.2656 , .9342 , -1.8966 , 3.5591 , .1415 , -.4978 , 1.0107 ,   &
      & -1.8966 , -.0697 , .2452 , -.4978 , .9342 , .0198 , -.0697 , .1415 , -.2656 , .1415 , -.4978 , 1.0107 , -1.8966 , -.0754 ,  &
      & .2653 , -.5386 , 1.0107 , .0371 , -.1307 , .2653 , -.4978 , -.0106 , .0371 , -.0754 , .1415 , -.0697 , .2452 , -.4978 ,     &
      & .9342 , .0371 , -.1307 , .2653 , -.4978 , -.0183 , .0644 , -.1307 , .2452 , .0052 , -.0183 , .0371 , -.0697/
   DATA ex2043/.0198 , -.0697 , .1415 , -.2656 , -.0106 , .0371 , -.0754 , .1415 , .0052 , -.0183 , .0371 , -.0697 , -.0015 ,       &
      & .0052 , -.0106 , .0198 , .0161 , -.0565 , .1147 , -.2152 , -.0086 , .0301 , -.0611 , .1147 , .0042 , -.0148 , .0301 ,       &
      & -.0565 , -.0012 , .0042 , -.0086 , .0161 , -.1030 , .3624 , -.7358 , 1.3808 , .0549 , -.1931 , .3921 , -.7358 , -.0270 ,    &
      & .0951 , -.1931 , .3624 , .0077 , -.0270 , .0549 , -.1030 , -.1030 , .3624 , -.7358 , 1.3808 , .0549 , -.1931 , .3921 ,      &
      & -.7358 , -.0270 , .0951 , -.1931 , .3624 , .0077 , -.0270 , .0549 , -.1030 , .0161 , -.0565 , .1147 , -.2152 , -.0086 ,     &
      & .0301 , -.0611 , .1147 , .0042 , -.0148 , .0301 , -.0565 , -.0012 , .0042 , -.0086 , .0161 , .0198 , -.0697 , .1415 ,       &
      & -.2656 , -.0106 , .0371 , -.0754 , .1415 , .0052 , -.0183 , .0371 , -.0697 , -.0015 , .0052 , -.0106 , .0198 , -.0697 ,     &
      & .2452 , -.4978 , .9342 , .0371 , -.1307 , .2653 , -.4978 , -.0183 , .0644 , -.1307 , .2452 , .0052 , -.0183 , .0371 ,       &
      & -.0697 , .1415 , -.4978 , 1.0107 , -1.8966 , -.0754 , .2653 , -.5386 , 1.0107 , .0371 , -.1307 , .2653 , -.4978 , -.0106 ,  &
      & .0371 , -.0754 , .1415 , -.2656 , .9342 , -1.8966 , 3.5591 , .1415 , -.4978 , 1.0107 , -1.8966 , -.0697 , .2452 , -.4978 ,  &
      & .9342 , .0198 , -.0697 , .1415 , -.2656 , -.0012 , .0042 , -.0086 , .0161 , .0077 , -.0270 , .0549 , -.1030/
   DATA ex2044/.0077 , -.0270 , .0549 , -.1030 , -.0012 , .0042 , -.0086 , .0161 , .0042 , -.0148 , .0301 , -.0565 , -.0270 ,       &
      & .0951 , -.1931 , .3624 , -.0270 , .0951 , -.1931 , .3624 , .0042 , -.0148 , .0301 , -.0565 , -.0086 , .0301 , -.0611 ,      &
      & .1147 , .0549 , -.1931 , .3921 , -.7358 , .0549 , -.1931 , .3921 , -.7358 , -.0086 , .0301 , -.0611 , .1147 , .0161 ,       &
      & -.0565 , .1147 , -.2152 , -.1030 , .3624 , -.7358 , 1.3808 , -.1030 , .3624 , -.7358 , 1.3808 , .0161 , -.0565 , .1147 ,    &
      & -.2152 , -.0012 , .0077 , .0077 , -.0012 , .0042 , -.0270 , -.0270 , .0042 , -.0086 , .0549 , .0549 , -.0086 , .0161 ,      &
      & -.1030 , -.1030 , .0161 , .0042 , -.0270 , -.0270 , .0042 , -.0148 , .0951 , .0951 , -.0148 , .0301 , -.1931 , -.1931 ,     &
      & .0301 , -.0565 , .3624 , .3624 , -.0565 , -.0086 , .0549 , .0549 , -.0086 , .0301 , -.1931 , -.1931 , .0301 , -.0611 ,      &
      & .3921 , .3921 , -.0611 , .1147 , -.7358 , -.7358 , .1147 , .0161 , -.1030 , -.1030 , .0161 , -.0565 , .3624 , .3624 ,       &
      & -.0565 , .1147 , -.7358 , -.7358 , .1147 , -.2152 , 1.3808 , 1.3808 , -.2152 , .0161 , -.1030 , -.1030 , .0161 , -.0565 ,   &
      & .3624 , .3624 , -.0565 , .1147 , -.7358 , -.7358 , .1147 , -.2152 , 1.3808 , 1.3808 , -.2152 , -.0086 , .0549 , .0549 ,     &
      & -.0086 , .0301 , -.1931 , -.1931 , .0301 , -.0611 , .3921 , .3921 , -.0611 , .1147 , -.7358 , -.7358 , .1147/
   DATA ex2045/.0042 , -.0270 , -.0270 , .0042 , -.0148 , .0951 , .0951 , -.0148 , .0301 , -.1931 , -.1931 , .0301 , -.0565 ,       &
      & .3624 , .3624 , -.0565 , -.0012 , .0077 , .0077 , -.0012 , .0042 , -.0270 , -.0270 , .0042 , -.0086 , .0549 , .0549 ,       &
      & -.0086 , .0161 , -.1030 , -.1030 , .0161 , -.2152 , 1.3808 , 1.3808 , -.2152 , .1147 , -.7358 , -.7358 , .1147 , -.0565 ,   &
      & .3624 , .3624 , -.0565 , .0161 , -.1030 , -.1030 , .0161 , .1147 , -.7358 , -.7358 , .1147 , -.0611 , .3921 , .3921 ,       &
      & -.0611 , .0301 , -.1931 , -.1931 , .0301 , -.0086 , .0549 , .0549 , -.0086 , -.0565 , .3624 , .3624 , -.0565 , .0301 ,      &
      & -.1931 , -.1931 , .0301 , -.0148 , .0951 , .0951 , -.0148 , .0042 , -.0270 , -.0270 , .0042 , .0161 , -.1030 , -.1030 ,     &
      & .0161 , -.0086 , .0549 , .0549 , -.0086 , .0042 , -.0270 , -.0270 , .0042 , -.0012 , .0077 , .0077 , -.0012 , .0161 ,       &
      & -.1030 , -.1030 , .0161 , -.0086 , .0549 , .0549 , -.0086 , .0042 , -.0270 , -.0270 , .0042 , -.0012 , .0077 , .0077 ,      &
      & -.0012 , -.0565 , .3624 , .3624 , -.0565 , .0301 , -.1931 , -.1931 , .0301 , -.0148 , .0951 , .0951 , -.0148 , .0042 ,      &
      & -.0270 , -.0270 , .0042 , .1147 , -.7358 , -.7358 , .1147 , -.0611 , .3921 , .3921 , -.0611 , .0301 , -.1931 , -.1931 ,     &
      & .0301 , -.0086 , .0549 , .0549 , -.0086 , -.2152 , 1.3808 , 1.3808 , -.2152 , .1147 , -.7358 , -.7358 , .1147/
   DATA ex2046/ - .0565 , .3624 , .3624 , -.0565 , .0161 , -.1030 , -.1030 , .0161 , .0198 , -.0106 , .0052 , -.0015 , -.0697 ,     &
      & .0371 , -.0183 , .0052 , .1415 , -.0754 , .0371 , -.0106 , -.2656 , .1415 , -.0697 , .0198 , -.0697 , .0371 , -.0183 ,      &
      & .0052 , .2452 , -.1307 , .0644 , -.0183 , -.4978 , .2653 , -.1307 , .0371 , .9342 , -.4978 , .2452 , -.0697 , .1415 ,       &
      & -.0754 , .0371 , -.0106 , -.4978 , .2653 , -.1307 , .0371 , 1.0107 , -.5386 , .2653 , -.0754 , -1.8966 , 1.0107 , -.4978 ,  &
      & .1415 , -.2656 , .1415 , -.0697 , .0198 , .9342 , -.4978 , .2452 , -.0697 , -1.8966 , 1.0107 , -.4978 , .1415 , 3.5591 ,    &
      & -1.8966 , .9342 , -.2656 , .0161 , -.0086 , .0042 , -.0012 , -.0565 , .0301 , -.0148 , .0042 , .1147 , -.0611 , .0301 ,     &
      & -.0086 , -.2152 , .1147 , -.0565 , .0161 , -.1030 , .0549 , -.0270 , .0077 , .3624 , -.1931 , .0951 , -.0270 , -.7358 ,     &
      & .3921 , -.1931 , .0549 , 1.3808 , -.7358 , .3624 , -.1030 , -.1030 , .0549 , -.0270 , .0077 , .3624 , -.1931 , .0951 ,      &
      & -.0270 , -.7358 , .3921 , -.1931 , .0549 , 1.3808 , -.7358 , .3624 , -.1030 , .0161 , -.0086 , .0042 , -.0012 , -.0565 ,    &
      & .0301 , -.0148 , .0042 , .1147 , -.0611 , .0301 , -.0086 , -.2152 , .1147 , -.0565 , .0161 , -.2656 , .1415 , -.0697 ,      &
      & .0198 , .9342 , -.4978 , .2452 , -.0697 , -1.8966 , 1.0107 , -.4978 , .1415 , 3.5591 , -1.8966 , .9342 , -.2656/
   DATA ex2047/.1415 , -.0754 , .0371 , -.0106 , -.4978 , .2653 , -.1307 , .0371 , 1.0107 , -.5386 , .2653 , -.0754 , -1.8966 ,     &
      & 1.0107 , -.4978 , .1415 , -.0697 , .0371 , -.0183 , .0052 , .2452 , -.1307 , .0644 , -.0183 , -.4978 , .2653 , -.1307 ,     &
      & .0371 , .9342 , -.4978 , .2452 , -.0697 , .0198 , -.0106 , .0052 , -.0015 , -.0697 , .0371 , -.0183 , .0052 , .1415 ,       &
      & -.0754 , .0371 , -.0106 , -.2656 , .1415 , -.0697 , .0198 , -.2152 , .1147 , -.0565 , .0161 , 1.3808 , -.7358 , .3624 ,     &
      & -.1030 , 1.3808 , -.7358 , .3624 , -.1030 , -.2152 , .1147 , -.0565 , .0161 , .1147 , -.0611 , .0301 , -.0086 , -.7358 ,    &
      & .3921 , -.1931 , .0549 , -.7358 , .3921 , -.1931 , .0549 , .1147 , -.0611 , .0301 , -.0086 , -.0565 , .0301 , -.0148 ,      &
      & .0042 , .3624 , -.1931 , .0951 , -.0270 , .3624 , -.1931 , .0951 , -.0270 , -.0565 , .0301 , -.0148 , .0042 , .0161 ,       &
      & -.0086 , .0042 , -.0012 , -.1030 , .0549 , -.0270 , .0077 , -.1030 , .0549 , -.0270 , .0077 , .0161 , -.0086 , .0042 ,      &
      & -.0012 , 3.5591 , -1.8966 , .9342 , -.2656 , -1.8966 , 1.0107 , -.4978 , .1415 , .9342 , -.4978 , .2452 , -.0697 , -.2656 , &
      & .1415 , -.0697 , .0198 , -1.8966 , 1.0107 , -.4978 , .1415 , 1.0107 , -.5386 , .2653 , -.0754 , -.4978 , .2653 , -.1307 ,   &
      & .0371 , .1415 , -.0754 , .0371 , -.0106 , .9342 , -.4978 , .2452 , -.0697 , -.4978 , .2653 , -.1307 , .0371/
   DATA ex2048/.2452 , -.1307 , .0644 , -.0183 , -.0697 , .0371 , -.0183 , .0052 , -.2656 , .1415 , -.0697 , .0198 , .1415 ,        &
      & -.0754 , .0371 , -.0106 , -.0697 , .0371 , -.0183 , .0052 , .0198 , -.0106 , .0052 , -.0015 , -.2152 , .1147 , -.0565 ,     &
      & .0161 , .1147 , -.0611 , .0301 , -.0086 , -.0565 , .0301 , -.0148 , .0042 , .0161 , -.0086 , .0042 , -.0012 , 1.3808 ,      &
      & -.7358 , .3624 , -.1030 , -.7358 , .3921 , -.1931 , .0549 , .3624 , -.1931 , .0951 , -.0270 , -.1030 , .0549 , -.0270 ,     &
      & .0077 , 1.3808 , -.7358 , .3624 , -.1030 , -.7358 , .3921 , -.1931 , .0549 , .3624 , -.1931 , .0951 , -.0270 , -.1030 ,     &
      & .0549 , -.0270 , .0077 , -.2152 , .1147 , -.0565 , .0161 , .1147 , -.0611 , .0301 , -.0086 , -.0565 , .0301 , -.0148 ,      &
      & .0042 , .0161 , -.0086 , .0042 , -.0012 , -.2656 , .1415 , -.0697 , .0198 , .1415 , -.0754 , .0371 , -.0106 , -.0697 ,      &
      & .0371 , -.0183 , .0052 , .0198 , -.0106 , .0052 , -.0015 , .9342 , -.4978 , .2452 , -.0697 , -.4978 , .2653 , -.1307 ,      &
      & .0371 , .2452 , -.1307 , .0644 , -.0183 , -.0697 , .0371 , -.0183 , .0052 , -1.8966 , 1.0107 , -.4978 , .1415 , 1.0107 ,    &
      & -.5386 , .2653 , -.0754 , -.4978 , .2653 , -.1307 , .0371 , .1415 , -.0754 , .0371 , -.0106 , 3.5591 , -1.8966 , .9342 ,    &
      & -.2656 , -1.8966 , 1.0107 , -.4978 , .1415 , .9342 , -.4978 , .2452 , -.0697 , -.2656 , .1415 , -.0697 , .0198/
   DATA ex2049/.0161 , -.0086 , .0042 , -.0012 , -.1030 , .0549 , -.0270 , .0077 , -.1030 , .0549 , -.0270 , .0077 , .0161 ,        &
      & -.0086 , .0042 , -.0012 , -.0565 , .0301 , -.0148 , .0042 , .3624 , -.1931 , .0951 , -.0270 , .3624 , -.1931 , .0951 ,      &
      & -.0270 , -.0565 , .0301 , -.0148 , .0042 , .1147 , -.0611 , .0301 , -.0086 , -.7358 , .3921 , -.1931 , .0549 , -.7358 ,     &
      & .3921 , -.1931 , .0549 , .1147 , -.0611 , .0301 , -.0086 , -.2152 , .1147 , -.0565 , .0161 , 1.3808 , -.7358 , .3624 ,      &
      & -.1030 , 1.3808 , -.7358 , .3624 , -.1030 , -.2152 , .1147 , -.0565 , .0161 , -.0008 , .0050 , .0050 , -.0008 , .0050 ,     &
      & -.0324 , -.0324 , .0050 , .0050 , -.0324 , -.0324 , .0050 , -.0008 , .0050 , .0050 , -.0008 , .0050 , -.0324 , -.0324 ,     &
      & .0050 , -.0324 , .2078 , .2078 , -.0324 , -.0324 , .2078 , .2078 , -.0324 , .0050 , -.0324 , -.0324 , .0050 , .0050 ,       &
      & -.0324 , -.0324 , .0050 , -.0324 , .2078 , .2078 , -.0324 , -.0324 , .2078 , .2078 , -.0324 , .0050 , -.0324 , -.0324 ,     &
      & .0050 , -.0008 , .0050 , .0050 , -.0008 , .0050 , -.0324 , -.0324 , .0050 , .0050 , -.0324 , -.0324 , .0050 , -.0008 ,      &
      & .0050 , .0050 , -.0008/
!
   DATA dtor/0.0174532925E0/
   DATA nequ/200/
   DATA oldeid/0/
   DATA lld , lsub , frlast/2* - 1 , 2* - 1.0E30/
   DATA typ/4HIHEX , 1H1 , 1H2 , 1H3/
!
!*****
!     IF THIS IS THE FIRST STRESS POINT IN AN ELEMENT, INITIALIZE
!     COUNTER AND GET EXTERNAL GRID POINT NUMBERS
!*****
   IF ( Istore==1 ) THEN
!
!     JUST FETCH APPROPRIATE SIGS AND LET ROUTINE COMPUTE PRINCIPAL
!     STRESSES AND WRITE( OUT RESULTS
!
      Strspt = Strspt + 1
      ipoint = 6*(Strspt-nip3-2)
      DO i = 1 , 6
         isub = ipoint + i
         sig(i) = sigs(isub)
         csig(i) = csigs(isub)
      ENDDO
!
      isave = Strspt
      Strspt = Strspt - nip3 - 1
!
!     SKIP PRINCIPAL STRESS COMPUTATIONS IF FINAL STRESS VECTOR
!     WILL BE COMPLEX.
!
      IF ( ktype==2 ) GOTO 600
!*****
!     SOLVE CUBIC EQUATION FOR PRINCIPAL STRESSES
!*****
!
!         S**3+P*S**2+Q*S+R=0.0
!
!     REF. -- CRC STANDARD MATH TABLES 14TH ED., PP. 392,3
!
      rm = 0.0
      DO i = 1 , 6
         IF ( abs(sig(i))>rm ) rm = abs(sig(i))
      ENDDO
      IF ( rm<=0.0 ) GOTO 300
      thresh = 1.0E-5
      DO
         DO i = 1 , 6
            IF ( abs(sig(i)/rm)<thresh ) sig(i) = 0.0
         ENDDO
         rx = sx/rm
         ry = sy/rm
         rz = sz/rm
         rxy = sxy/rm
         ryz = syz/rm
         rzx = szx/rm
         p = -rx - ry - rz
         q = rx*ry + ry*rz + rz*rx - rxy**2 - ryz**2 - rzx**2
         r = -(rx*ry*rz+2.0*rxy*ryz*rzx-rx*ryz**2-ry*rzx**2-rz*rxy**2)
         a = (3.0*q-p**2)/3.0
         b = (2.0*p**3-9.0*p*q+27.0*r)/27.0
         x = -a**3/27.0
         IF ( x>1.0E-16 ) THEN
            cosphi = -(b/2.0)/sqrt(x)
            ax = abs(cosphi)
            IF ( ax>0.9999 .AND. ax<1.0001 ) cosphi = sign(1.0,cosphi)
            IF ( abs(cosphi)<=1.0 ) THEN
               phi = acos(cosphi)
               x = 2.0*sqrt(-a/3.0)
               GOTO 400
            ENDIF
!
!     CHECK FOR IMAGINARY ROOTS
!
         ELSEIF ( abs(x)<=rm*1.0E-6 ) THEN
!
!     CHECK FOR 3 EQUAL ROOTS
!
            IF ( abs(b)<=1.0E-6 ) THEN
               x = 0.0
               phi = 0.0
               GOTO 400
            ENDIF
         ENDIF
         thresh = 10.0*thresh
         IF ( thresh>=1.1E-3 ) GOTO 300
      ENDDO
   ELSE
      IF ( oldeid/=iesta(1) ) THEN
         Strspt = 0
         ipts = (Type-1)/2
         ngp = 12*Type - 4
         ngp1 = ngp + 1
         IF ( Type==3 ) ngp1 = 21
         Nip = iesta(20*ngp+9)
!
!     IF EQEXIN NOT YET READ IN, READ IT.
!
         IF ( isopl==eqexin .OR. oldeid==0 ) THEN
            isopl = -1
            itrl(1) = eqexin
            CALL rdtrl(itrl)
            leqx = itrl(2)*2
            mxleq = (nequ/2)*2
            neqx = (leqx-1)/mxleq + 1
            l = leqx
            IF ( neqx>1 ) l = mxleq
            iend = 0
            CALL read(*100,*100,eqexin,equ,l,0,i)
            DO i = 2 , l , 2
               equ(i) = iabs(equ(i))
            ENDDO
            CALL sort(0,0,2,2,equ,l)
            l = l/2
         ENDIF
!
!     CONVERT SIL NUMBERS TO EXTERNAL GRID POINT NUMBERS
!
         oldeid = iesta(1)
         DO i = 1 , ngp
            extrnl(i) = -iesta(i+1)
         ENDDO
         DO j = 1 , neqx
 10         DO i = 1 , ngp
               IF ( extrnl(i)<=0 ) THEN
                  sil = iesta(i+1)*10 + 1
!
!     BINARY SEARCH FOR MATCH ON SIL NUMBER
!
                  klo = 1
                  khi = l
                  k = (khi+klo+1)/2
                  DO
                     kx = 2*k
                     IF ( sil<equ(kx) ) THEN
                        khi = k
                     ELSEIF ( sil==equ(kx) ) THEN
                        extrnl(i) = equ(kx-1)
                        EXIT
                     ELSE
                        klo = k
                     ENDIF
                     IF ( khi-klo<1 ) EXIT
                     IF ( khi-klo==1 ) THEN
                        IF ( k==klo ) THEN
                           k = khi
                        ELSE
                           k = klo
                        ENDIF
                        klo = khi
                     ELSE
                        k = (khi+klo+1)/2
                     ENDIF
                  ENDDO
               ENDIF
            ENDDO
            IF ( neqx==1 ) CYCLE
            DO i = 1 , ngp
               IF ( extrnl(i)<0 ) GOTO 20
            ENDDO
            EXIT
 20         l = mxleq
            iend = 0
            CALL read(*100,*40,eqexin,equ,l,0,i)
 30         DO i = 2 , l , 2
               equ(i) = iabs(equ(i))
            ENDDO
            CALL sort(0,0,2,2,equ,l)
            l = l/2
            IF ( iend/=1 ) CYCLE
            GOTO 10
 40         CALL bckrec(eqexin)
            l = i
            iend = 1
            IF ( l/=0 ) GOTO 30
            GOTO 20
         ENDDO
         IF ( Type/=3 ) extrnl(ngp+1) = 0
         IF ( iend==0 ) CALL bckrec(eqexin)
         iend = 1
      ENDIF
      GOTO 200
   ENDIF
 100  CALL mesage(-61,0,0)
!*****
!     BEGIN STRESS COMPUTATION
!*****
 200  Strspt = Strspt + 1
   IF ( Strspt==Nip**3+1 ) oldeid = 0
   Istore = 0
   IF ( oldeid==0 ) Istore = 1
!*****
!     THERMAL EFFECTS
!*****
   IF ( jtemp==-1 ) THEN
      DO i = 1 , 6
         sig(i) = 0.0
         csig(i) = 0.0
      ENDDO
   ELSE
!
!     COMPUTE TEMPERATURE AT THIS POINT
!
      temp = 0.0
      DO i = 1 , ngp
         temp = temp + esta(ngp+1+i)*Gpt(i)
      ENDDO
      temp = temp - esta(2*ngp+2)
      DO i = 1 , 6
         sig(i) = temp*esta(2*ngp+2+i)
         csig(i) = abs(sig(i))
      ENDDO
   ENDIF
!*****
!     DISPLACEMENT EFFECTS.  LOOP OVER GRID POINTS.
!*****
   DO i = 1 , ngp
      j = ivec + iesta(i+1) - 1
      k = ngp*2 + 18*(i-1) + 9
      CALL smmats(esta(k),6,3,-2,z(j),3,1,0,sig,csig)
   ENDDO
!
!     STORE THE GAUSS POINT STRESSES UNTIL WE HAVE THEM ALL
!     NO NEED TO STORE NIP3 + 1ST SINCE CENTROIDAL VALUES WILL BE
!     EXTRAPOLATED. ACTUALLY, NIP3 + 1ST TIMES THRU SIHEX1 AND 2 ARE
!     NOW SUPERFLUOUS
!
   nip3 = Nip**3
   IF ( Strspt/=nip3+1 ) THEN
      ipoint = 6*(Strspt-1)
      DO i = 1 , 6
         isub = ipoint + i
         store(isub) = sig(i)
      ENDDO
   ENDIF
!
!     IF ALL GAUSS POINT  ARE DONE, EXTRAPOLATE TO GRIDS
!
   IF ( oldeid/=0 ) RETURN
!
   IF ( ngp<20 ) THEN
!
!     8 GRIDS
!
      IF ( Nip<3 ) THEN
         CALL smmats(ex8g2,9,8,0,store,8,6,0,sigs,csigs)
      ELSEIF ( Nip==3 ) THEN
         CALL smmats(ex8g3,9,27,0,store,27,6,0,sigs,csigs)
      ELSE
         CALL smmats(ex8g4,9,64,0,store,64,6,0,sigs,csigs)
      ENDIF
!
!     20 OR 32 GRIDS
!
   ELSEIF ( Nip<3 ) THEN
      CALL smmats(ex20g2,21,8,0,store,8,6,0,sigs,csigs)
   ELSEIF ( Nip==3 ) THEN
      CALL smmats(ex20g3,21,27,0,store,27,6,0,sigs,csigs)
   ELSE
      CALL smmats(ex20g4,21,64,0,store,64,6,0,sigs,csigs)
   ENDIF
   RETURN
 300  sa = 0.0
   sb = 0.0
   sc = 0.0
   GOTO 500
 400  sa = (x*cos(phi/3.0)-p/3.0)*rm
   sb = (x*cos(phi/3.0+120.0*dtor)-p/3.0)*rm
   sc = (x*cos(phi/3.0+240.0*dtor)-p/3.0)*rm
   rm = 0.0
   DO i = 1 , 3
      IF ( abs(sigp(i))>rm ) rm = abs(sigp(i))
   ENDDO
   DO i = 1 , 3
      IF ( abs(sigp(i)/rm)<1.0E-5 ) sigp(i) = 0.0
   ENDDO
!*****
!     COMPUTE MEAN STRESS OR PRESSURE
!*****
 500  sn = -(sa+sb+sc)/3.0
!*****
!     COMPUTE OCTAHEDRAL SHEAR STRESS
!*****
   so = sqrt(((sa+sn)**2+(sb+sn)**2+(sc+sn)**2)/3.0)
!*****
!     COMPUTE DIRECTION COSINES OF THE PRINCIPAL PLANES
!*****
   rm = 1.0E-6
   DO i = 1 , 3
      IF ( sigp(i)/=0.0 ) THEN
         smat(1,1) = 1.0 - sx/sigp(i)
         smat(2,1) = -sxy/sigp(i)
         smat(3,1) = -szx/sigp(i)
         smat(1,2) = smat(2,1)
         smat(2,2) = 1.0 - sy/sigp(i)
         smat(3,2) = -syz/sigp(i)
         smat(1,3) = smat(3,1)
         smat(2,3) = smat(3,2)
         smat(3,3) = 1.0 - sz/sigp(i)
         CALL saxb(smat(1,1),smat(1,2),dcos(1,i))
         rx = sadotb(dcos(1,i),dcos(1,i))
         j = 1
         CALL saxb(smat(1,2),smat(1,3),dcos(1,i))
         ry = sadotb(dcos(1,i),dcos(1,i))
         IF ( ry>rx ) j = 2
         CALL saxb(smat(1,3),smat(1,1),dcos(1,i))
         rz = sadotb(dcos(1,i),dcos(1,i))
         IF ( rz>ry .AND. rz>rx ) j = 3
         p = smat(1,j)
         q = smat(2,j)
         r = smat(3,j)
         IF ( j<2 ) THEN
            j = 2
         ELSEIF ( j==2 ) THEN
            j = 3
         ELSE
            j = 1
         ENDIF
         s = smat(1,j)
         t = smat(2,j)
         v = smat(3,j)
         IF ( abs(q)>rm ) THEN
            rx = v - t*r/q
            IF ( abs(rx)<=rm ) THEN
               rx = s - t*p/q
               IF ( abs(rx)<=rm ) GOTO 550
               ry = -r/q
               x = 1.0 + ry*ry
               dcos(1,i) = 0.0
               dcos(3,i) = 1.0/sqrt(x)
               dcos(2,i) = ry*dcos(3,i)
               CYCLE
            ELSE
               rz = -(s-t*p/q)/rx
               ry = -(p+r*rz)/q
            ENDIF
         ELSEIF ( abs(r)<=rm ) THEN
            IF ( abs(p)<=rm ) GOTO 550
            IF ( abs(v)<=rm ) THEN
               IF ( abs(t)<=rm ) GOTO 550
               dcos(1,i) = 0.0
               dcos(2,i) = 0.0
               dcos(3,i) = 1.0
               CYCLE
            ELSE
               rz = -t/v
               x = 1.0 + rz*rz
               dcos(1,i) = 0.0
               dcos(2,i) = 1.0/sqrt(x)
               dcos(3,i) = rz*dcos(2,i)
               CYCLE
            ENDIF
         ELSE
            rz = -p/r
            IF ( abs(t)<=rm ) THEN
               IF ( abs(s-v*p/r)<=rm ) GOTO 550
               dcos(1,i) = 0.0
               dcos(2,i) = 1.0
               dcos(3,i) = 0.0
               CYCLE
            ELSE
               ry = -(s-v*p/r)/t
            ENDIF
         ENDIF
         x = 1.0 + rz*rz + ry*ry
         dcos(1,i) = 1.0/sqrt(x)
         dcos(2,i) = ry*dcos(1,i)
         dcos(3,i) = rz*dcos(1,i)
         CYCLE
      ENDIF
 550  dcos(1,i) = 0.0
      dcos(2,i) = 0.0
      dcos(3,i) = 0.0
   ENDDO
!*****
!     PUT IT AWAY IN THE STRESS ARRAY
!*****
 600  istrs(1) = iesta(1)
   IF ( Type==3 ) THEN
      istrs(11) = 0
!            1   2   3   4   5   6   7   8   9   10
      IF ( Strspt==2 .OR. Strspt==4 .OR. Strspt==6 ) THEN
         j = (Strspt-1)/2 + Strspt - 1
         k = j + 3
      ELSEIF ( Strspt==8 ) THEN
         j = (Strspt-1)/2 + Strspt - 1
         k = j - 9
      ELSEIF ( Strspt==9 .OR. Strspt==10 .OR. Strspt==11 .OR. Strspt==12 ) THEN
         j = (Strspt-9)*3 + 1
         k = j + 20
      ELSEIF ( Strspt==13 .OR. Strspt==15 .OR. Strspt==17 .OR. Strspt==19 ) THEN
         j = Strspt/2 + Strspt + 2
         GOTO 650
      ELSEIF ( Strspt==14 .OR. Strspt==16 .OR. Strspt==18 ) THEN
         j = (Strspt-1)/2 + Strspt + 1
         k = j + 3
      ELSEIF ( Strspt==20 ) THEN
         j = (Strspt-1)/2 + Strspt + 1
         k = j - 9
      ELSEIF ( Strspt==21 ) THEN
         istrs(2) = 0
         GOTO 700
      ELSE
         j = Strspt/2 + Strspt
         GOTO 650
      ENDIF
      istrs(11) = extrnl(k)
 650  istrs(2) = extrnl(j)
   ELSE
      istrs(2) = extrnl(Strspt)
   ENDIF
 700  stress(3) = sx
   stress(4) = sxy
   stress(5) = sa
   stress(9) = sn
   stress(10) = so
   stress(ipts+11) = sy
   stress(ipts+12) = syz
   stress(ipts+13) = sb
   stress(ipts+17) = sz
   stress(ipts+18) = szx
   stress(ipts+19) = sc
   DO i = 1 , 3
      stress(5+i) = dcos(1,i)
      stress(ipts+13+i) = dcos(2,i)
      stress(ipts+19+i) = dcos(3,i)
   ENDDO
   Strspt = isave
   IF ( nchk>0 ) THEN
!
!   . CHECK PRECISION...
!
      kk = 0
      CALL sdrchk(sig,csig,6,kk)
!
      IF ( kk/=0 ) THEN
!
!   . LIMITS EXCEEDED...
!
         jj = 0
         ifrvec(1) = typ(1)
         IF ( Type==1 ) ifrvec(2) = typ(2)
         IF ( Type==2 ) ifrvec(2) = typ(3)
         IF ( Type==3 ) ifrvec(2) = typ(4)
         ifrvec(3) = iesta(1)
         ifrvec(4) = istrs(2)
         ifrvec(5) = istrs(11)
         IF ( Type/=3 ) ifrvec(5) = -1
!
         IF ( lsub/=isub .OR. frlast(1)/=frtmei(1) .OR. lld/=ild .OR. frlast(2)/=frtmei(2) ) THEN
!
            lsub = isub
            lld = ild
            frlast(1) = frtmei(1)
            frlast(2) = frtmei(2)
            jj = 1
            CALL page1
!
         ELSEIF ( eject(2)==0 ) THEN
            GOTO 720
         ENDIF
!
         CALL sd2rhd(ishd,jj)
         line = line + 1
         WRITE (nout,99001)
99001    FORMAT (7X,4HTYPE,5X,3HEID,4X,4HGRD1,4X,4HGRD2,5X,2HSX,5X,2HSY,5X,2HSZ,4X,3HSXY,4X,3HSYZ,4X,3HSZX)
 720     WRITE (nout,99002) ifrvec
99002    FORMAT (1H0,3X,2A4,I7,2I8,6F7.1)
      ENDIF
   ENDIF
END SUBROUTINE sihex2
